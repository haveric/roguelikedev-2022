"use strict";(self.webpackChunkroguelikedev_2022=self.webpackChunkroguelikedev_2022||[]).push([[143],{890:(e,t,s)=>{s.d(t,{Z:()=>i});var n=s(537),r=s.n(n),o=s(645),a=s.n(o)()(r());a.push([e.id,"* {\n    box-sizing: border-box;\n}\n\nbody {\n    margin: 0 auto;\n    overflow: hidden;\n    width: 100vw;\n    height: 100vh;\n    font-size: 1.2vh;\n}","",{version:3,sources:["webpack://./src/styles/style.css"],names:[],mappings:"AAAA;IACI,sBAAsB;AAC1B;;AAEA;IACI,cAAc;IACd,gBAAgB;IAChB,YAAY;IACZ,aAAa;IACb,gBAAgB;AACpB",sourcesContent:["* {\n    box-sizing: border-box;\n}\n\nbody {\n    margin: 0 auto;\n    overflow: hidden;\n    width: 100vw;\n    height: 100vh;\n    font-size: 1.2vh;\n}"],sourceRoot:""}]);const i=a},645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var s="",n=void 0!==t[5];return t[4]&&(s+="@supports (".concat(t[4],") {")),t[2]&&(s+="@media ".concat(t[2]," {")),n&&(s+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),s+=e(t),n&&(s+="}"),t[2]&&(s+="}"),t[4]&&(s+="}"),s})).join("")},t.i=function(e,s,n,r,o){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(n)for(var i=0;i<this.length;i++){var c=this[i][0];null!=c&&(a[c]=!0)}for(var l=0;l<e.length;l++){var h=[].concat(e[l]);n&&a[h[0]]||(void 0!==o&&(void 0===h[5]||(h[1]="@layer".concat(h[5].length>0?" ".concat(h[5]):""," {").concat(h[1],"}")),h[5]=o),s&&(h[2]?(h[1]="@media ".concat(h[2]," {").concat(h[1],"}"),h[2]=s):h[2]=s),r&&(h[4]?(h[1]="@supports (".concat(h[4],") {").concat(h[1],"}"),h[4]=r):h[4]="".concat(r)),t.push(h))}},t}},537:e=>{e.exports=function(e){var t=e[1],s=e[3];if(!s)return t;if("function"==typeof btoa){var n=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),r="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),o="/*# ".concat(r," */"),a=s.sources.map((function(e){return"/*# sourceURL=".concat(s.sourceRoot||"").concat(e," */")}));return[t].concat(a).concat([o]).join("\n")}return[t].join("\n")}},379:e=>{var t=[];function s(e){for(var s=-1,n=0;n<t.length;n++)if(t[n].identifier===e){s=n;break}return s}function n(e,n){for(var o={},a=[],i=0;i<e.length;i++){var c=e[i],l=n.base?c[0]+n.base:c[0],h=o[l]||0,d="".concat(l," ").concat(h);o[l]=h+1;var u=s(d),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==u)t[u].references++,t[u].updater(p);else{var f=r(p,n);n.byIndex=i,t.splice(i,0,{identifier:d,updater:f,references:1})}a.push(d)}return a}function r(e,t){var s=t.domAPI(t);return s.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;s.update(e=t)}else s.remove()}}e.exports=function(e,r){var o=n(e=e||[],r=r||{});return function(e){e=e||[];for(var a=0;a<o.length;a++){var i=s(o[a]);t[i].references--}for(var c=n(e,r),l=0;l<o.length;l++){var h=s(o[l]);0===t[h].references&&(t[h].updater(),t.splice(h,1))}o=c}}},569:e=>{var t={};e.exports=function(e,s){var n=function(e){if(void 0===t[e]){var s=document.querySelector(e);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(e){s=null}t[e]=s}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(s)}},216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,s)=>{e.exports=function(e){var t=s.nc;t&&e.setAttribute("nonce",t)}},795:e=>{e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(s){!function(e,t,s){var n="";s.supports&&(n+="@supports (".concat(s.supports,") {")),s.media&&(n+="@media ".concat(s.media," {"));var r=void 0!==s.layer;r&&(n+="@layer".concat(s.layer.length>0?" ".concat(s.layer):""," {")),n+=s.css,r&&(n+="}"),s.media&&(n+="}"),s.supports&&(n+="}");var o=s.sourceMap;o&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,s)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},856:(e,t,s)=>{var n=s(379),r=s.n(n),o=s(795),a=s.n(o),i=s(569),c=s.n(i),l=s(565),h=s.n(l),d=s(216),u=s.n(d),p=s(589),f=s.n(p),m=s(890),w={};w.styleTagTransform=f(),w.setAttributes=h(),w.insert=c().bind(null,"head"),w.domAPI=a(),w.insertStyleElement=u(),r()(m.Z,w),m.Z&&m.Z.locals&&m.Z.locals;class y{constructor(e){this.entity=e}perform(){console.error("Not Implemented")}isPlayer(){return this.entity===A.player}}class v extends y{constructor(e){super(e)}perform(){return this}}class g extends y{constructor(e,t){super(e),this.reason=t}perform(){return this}}const x=new class{constructor(){this.eventHandler=null,this.player=null,this.gameMap=null,this.needsRenderUpdate=!1}handleEvents(){this.processAction(this.eventHandler.handleInput())}processAction(e){if(e&&this.eventHandler.isPlayerTurn){const t=e.perform();return!(t instanceof v||(t instanceof g?(t.reason&&console.log(t.reason),1):(x.needsRenderUpdate=!0,this.handleEnemyTurns(),0)))}}handleEnemyTurns(){}},A=x,E=new class{constructor(){this.setupGameHtml(),this.resizeCanvas(),window.addEventListener("resize",this)}setupGameHtml(){const e=document.createElement("div");e.classList.add("game"),this.canvas=document.createElement("canvas"),this.canvas.classList.add("view"),e.appendChild(this.canvas),document.body.appendChild(e),this.ctx=this.canvas.getContext("2d")}handleEvent(e){"resize"===e.type&&this.resizeCanvas()}resizeCanvas(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,A.needsRenderUpdate=!0}clearAll(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}};class k{static PI=Math.PI;static HEX_A=this.PI/3;static HEX_RADIUS=20;constructor(){}static drawHex(e,t,s){e.beginPath();for(let n=0;n<6;n++)e.lineTo(t+k.HEX_RADIUS*Math.cos(k.HEX_A*n),s+k.HEX_RADIUS*Math.sin(k.HEX_A*n));e.closePath()}}class b{constructor(e,t){this.q=e,this.r=t,this.s=-e-t,this.isWall=0}static add(e,t){return new b(e.q+t.q,e.r+t.r)}static subtract(e,t){return new b(e.q-t.q,e.r-t.r)}static multiply(e,t){return new b(e.q*t,e.r*t)}getDisplayX(){return this.q+this.r/2}getX(){return Math.floor(this.q+this.r/2)}getY(){return this.r}static hexToArray(e,t){return{x:Math.floor(e+t/2),y:t}}static getHexFromArray(e,t,s){const n=b.hexToArray(t,s);return e[n.x]&&e[n.x][n.y]?e[n.x][n.y]:null}getAdjacentHexes(e){const t=b.getHexFromArray(e,this.q,this.r-1),s=b.getHexFromArray(e,this.q+1,this.r-1),n=b.getHexFromArray(e,this.q+1,this.r),r=b.getHexFromArray(e,this.q,this.r+1),o=b.getHexFromArray(e,this.q-1,this.r+1),a=b.getHexFromArray(e,this.q-1,this.r),i=[];return null!==t&&i.push(t),null!==s&&i.push(s),null!==n&&i.push(n),null!==r&&i.push(r),null!==o&&i.push(o),null!==a&&i.push(a),i}isEdge(e){return this.getAdjacentHexes(e).length<6}getNumAdjacentWalls(e){const t=b.getHexFromArray(e,this.q,this.r-1),s=b.getHexFromArray(e,this.q+1,this.r-1),n=b.getHexFromArray(e,this.q+1,this.r),r=b.getHexFromArray(e,this.q,this.r+1),o=b.getHexFromArray(e,this.q-1,this.r+1),a=b.getHexFromArray(e,this.q-1,this.r);return b.isWall(t)+b.isWall(s)+b.isWall(n)+b.isWall(r)+b.isWall(o)+b.isWall(a)}static isWall(e){return null===e||e.isWall?1:0}draw(e,t){k.drawHex(E.ctx,e,t),this.isWall&&(E.ctx.fillStyle="gray",E.ctx.fill()),E.ctx.stroke(),E.ctx.textAlign="center",E.ctx.textBaseline="middle"}}class H extends class{constructor(){}draw(){}}{constructor(){super(),this.hex=new b(0,10)}draw(){const e=k.HEX_RADIUS+k.HEX_RADIUS*(1+Math.cos(k.HEX_A))*this.hex.getY(),t=1.15*k.HEX_RADIUS+2*k.HEX_RADIUS*Math.sin(k.HEX_A)*this.hex.getDisplayX();k.drawHex(E.ctx,e,t),E.ctx.fillStyle="blue",E.ctx.fill(),E.ctx.fillStyle="white",E.ctx.textAlign="center",E.ctx.textBaseline="middle",E.ctx.font="26px serif",E.ctx.fillText("@",e,t)}}const M="ArrowUp",D="ArrowDown",N="Left Shift",C="Right Shift",I="Numpad .",S="Numpad 0",R="Numpad 1",L="Numpad 2",U="Numpad 3",q="Numpad 4",W="Numpad 5",X="Numpad 6",P="Numpad 7",T="Numpad 8",_="Numpad 9",F="Numpad Delete",B="Numpad Insert",j="Numpad End",z="Numpad ArrowDown",K="Numpad PageDown",Z="Numpad ArrowLeft",Y="Numpad Clear",J="Numpad ArrowRight",O="Numpad Home",G="Numpad ArrowUp",Q="Numpad PageUp",V=new class{constructor(){const e=this;e.defaultDelay=25,e.lastShiftUp=null,e.treatShiftNumpadEqual=!0,e.keysDown=[],e.keysDelayed=[],e.defaults=new Map,e.controls=new Map,e.defaults.set("up",[T,M]),e.defaults.set("down",[L,D]),e.defaults.set("nw",[P]),e.defaults.set("ne",[_]),e.defaults.set("sw",[R]),e.defaults.set("se",[U]),e.defaults.set("wait",[W]),e.load(),addEventListener("keydown",(function(t){"/"===t.key&&t.preventDefault(),e.treatShiftNumpadEqual&&t.getModifierState("NumLock")&&!t.shiftKey&&t.code.startsWith("Numpad")&&t.keyCode<90&&e.lastShiftUp&&(e.keysDown[e.lastShiftUp]=!0);const s=e.getKey(t.key,t.code);e.keysDown[s]=!0}),!1),addEventListener("keyup",(function(t){const s=e.getKey(t.key,t.code);s!==N&&s!==C||(e.lastShiftUp=s),delete e.keysDown[s],delete e.keysDelayed[s]}),!1)}getKey(e,t){if(t.startsWith("Arrow")||(t.endsWith("Left")?e="Left "+e:t.endsWith("Right")?e="Right "+e:t.startsWith("Numpad")&&(e="Numpad "+e)),this.treatShiftNumpadEqual)switch(e){case F:e=I;break;case B:e=S;break;case j:e=R;break;case z:e=L;break;case K:e=U;break;case Z:e=q;break;case Y:e=W;break;case J:e=X;break;case O:e=P;break;case G:e=T;break;case Q:e=_}return e}load(){const e=localStorage.getItem("controls");e?this.controls=new Map(JSON.parse(e)):this.resetToDefault()}save(){localStorage.setItem("controls",JSON.stringify(Array.from(this.controls.entries())))}setControls(e){this.controls=new Map;for(const[t,s]of e.entries()){const e=[];for(const t of s)e.push(t);this.controls.set(t,e)}this.save()}resetToDefault(){this.setControls(this.defaults)}clone(){const e=new Map;for(const[t,s]of this.controls.entries()){const n=[];for(const e of s)n.push(e);e.set(t,n)}return e}isPressed(e){const t=this;let s=!1,n=t.controls.get(e);if(!n){const s=t.defaults.get(e);s?(t.controls.set(e,s),t.save(),n=s):console.error("Missing keybindings for: ",e,n)}return n.forEach((function(e){e in t.keysDown&&(s=!0)})),s}isDelayed(e){const t=this;let s=!1;return this.controls.get(e).forEach((function(e){e in t.keysDelayed&&(s=!0)})),s}deleteKey(e,t){const s=this;s.controls.get(e).forEach((function(e){delete s.keysDown[e],t&&(s.keysDelayed[e]=!0)})),t&&setTimeout((function(){s.controls.get(e).forEach((function(e){delete s.keysDelayed[e]}))}),t)}testPressed(e,t){t=t||this.defaultDelay;const s=this;let n=!1;return s.isPressed(e)&&!s.isDelayed(e)&&(s.deleteKey(e,t),n=!0),n}};class $ extends y{constructor(e,t=0,s=0){super(e),this.dq=t,this.dr=s}perform(){console.error("Not Implemented")}}class ee extends ${constructor(e,t,s){super(e,t,s)}perform(){if(this.entity.hex){const e=b.add(this.entity.hex,new b(this.dq,this.dr));if(!A.gameMap.isInBounds(e.getX(),e.getY()))return new g(this.entity,"Location is outside of the map!");this.entity.hex.q+=this.dq,this.entity.hex.r+=this.dr}return this}}class te extends class{constructor(){this.mouseDown=!1,window.addEventListener("mousemove",this),window.addEventListener("mousedown",this),window.addEventListener("mouseup",this),window.addEventListener("click",this),window.addEventListener("contextmenu",this),window.addEventListener("change",this),window.addEventListener("keydown",this),this.isPlayerTurn=!0}teardown(){window.removeEventListener("mousemove",this),window.removeEventListener("mousedown",this),window.removeEventListener("mouseup",this),window.removeEventListener("click",this),window.removeEventListener("contextmenu",this),window.removeEventListener("change",this),window.removeEventListener("keydown",this)}handleEvent(e){switch(e.type){case"mousemove":this.onMouseMove(e);break;case"mousedown":this.onMouseDown(e);break;case"mouseup":this.onMouseUp(e);break;case"click":this.onLeftClick(e);break;case"contextmenu":this.onRightClick(e);break;case"change":this.onChange(e);break;case"keydown":this.onKeydown(e)}}handleInput(){}onMouseMove(){}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onLeftClick(){}onRightClick(){}onChange(){}onKeydown(){}}{constructor(){super()}teardown(){super.teardown()}handleInput(){let e=null;return this.isPlayerTurn&&(V.testPressed("up")?e=new ee(A.player,-1,0):V.testPressed("down")?e=new ee(A.player,1,0):V.testPressed("nw")?e=new ee(A.player,0,-1):V.testPressed("ne")?e=new ee(A.player,-1,1):V.testPressed("sw")?e=new ee(A.player,1,-1):V.testPressed("se")&&(e=new ee(A.player,0,1))),e}}class se extends class{constructor(e,t){this.rows=e,this.cols=t,this.init()}init(){this.hexes=[];for(let e=0;e<this.rows;e++){this.hexes[e]=[];for(let t=0;t<this.cols;t++)this.hexes[e][t]=new b(e-Math.floor(t/2),t)}this.actors=[]}isInBounds(e,t){return 0<=e&&e<this.rows&&0<=t&&t<this.cols}create(){}draw(){for(let e=0;e<this.rows;e++){let t=2*k.HEX_RADIUS+2*k.HEX_RADIUS*Math.sin(k.HEX_A)*e;for(let s=0;s<this.cols;s++){const n=k.HEX_RADIUS+k.HEX_RADIUS*(1+Math.cos(k.HEX_A))*s;t-=(-1)**s*k.HEX_RADIUS*Math.sin(k.HEX_A),this.hexes[e][s].draw(n,t)}}for(const e of this.actors)e.draw()}}{constructor(e,t){super(e,t),this.percentAreWalls=.35,this.create()}create(){this.randomFillBuild(),this.makeCaverns(15,0)}randomFillBuild(){const e=Math.floor(Math.random()*this.rows),t=Math.floor(Math.random()*this.cols);for(let s=0;s<this.rows;s++)for(let n=0;n<this.cols;n++)this.hexes[s][n].isEdge(this.hexes)?this.hexes[s][n].isWall=1:s===e||n===t?this.hexes[s][n].isWall=0:Math.random()<this.percentAreWalls?this.hexes[s][n].isWall=1:this.hexes[s][n].isWall=0}addRandomNoise(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.cols;t++)Math.random()<.02&&(this.hexes[e][t].isWall=1)}makeCaverns(e,t){this.addRandomNoise();for(let e=0;e<this.rows;e++)for(let t=0;t<this.cols;t++)this.hexes[e][t].isWall=this.placeWallLogic(this.hexes[e][t]);e--;const s=this;e>0?t>0?(setTimeout((()=>{s.makeCaverns(e,t)}),t),A.needsRenderUpdate=!0):s.makeCaverns(e):A.needsRenderUpdate=!0}placeWallLogic(e){const t=e.getNumAdjacentWalls(this.hexes);if(e.isEdge(this.hexes))return 1;if(e.isWall){if(t>=2)return 1}else if(t>=4)return 1;return 0}}A.gameMap=new se(35,80),A.player=new H,A.gameMap.actors.push(A.player),A.eventHandler=new te,A.needsRenderUpdate=!0,window.requestAnimationFrame((function e(){A.handleEvents(),A.needsRenderUpdate&&(E.clearAll(),A.gameMap.draw(),A.needsRenderUpdate=!1),window.requestAnimationFrame(e)}))}},e=>{e(e.s=856)}]);
//# sourceMappingURL=app.9706b2c23354d37dada6.js.map